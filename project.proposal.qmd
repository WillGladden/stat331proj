---
title: "STAT331 Final Project Proposal"
author: "Giovani Thai, William Gladden, Soren Paetau"
format: 
  html:
    self-contained: true
    code-tools: true
    code-fold: true
    toc: true
    number-sections: true
    smooth-scroll: true
editor: source
execute: 
  error: true
  echo: true
  message: false
  warning: false
---

```{r setup}
library(tidyverse)
```

# Project Proposal



## Data Description
```{r import}

sanitation.data <- read.csv("at_least_basic_sanitation_overall_access_percent.csv", check.names = F)
income.data <- read.csv("income_per_person_gdppercapita_ppp_inflation_adjusted.csv")
colnames(income.data) <- c("country", as.numeric(1799:2049))
```

### Income Dataset
```{r}
head(select(income.data, 1:5))
```
The income data set measures the total GDP of a country per person for 216 countries between the years of 1892 and 2049, with units in fixed 2017 prices. This number is adjusted for PPP, or the differences between costs of living and essential products, across countries. The data comes from the World Bank, the Maddison Project Database, and the Penn World Table. Historical estimates were used for early years; forecasts from the IMF's Economic Outlook were used to project income in the future.

Source: <https://www.gapminder.org/data/documentation/gd001/>

### Sanitation  Dataset
```{r}
head(select(sanitation.data, 1:5))
```
The sanitation data set measures the percentage of people (living in both urban and rural settings) who use at lease basic sanitation services not shared with other households. This includes:

+ flushing/pouring to piped sewer systems
+ septic
+ ventilation for pit latrines (e.g. squat toilets)

The data was collected by the World Health Organization and UNICEF, falling between the years of 1999 to 2019.

Source: <https://data.worldbank.org/indicator/SH.STA.SMSS.ZS>

## Hypothesized Relationship
We hypothesize that there will be a positive relation between income per person and percentage of people with basic sanitation at their disposal. We would also like to investigate and highlight any potential outliers, such as moments in time where certain countries failed to improve sanitation with increased income, or drastic dips/surges in income/sanitation over a single year.


## Data Cleaning Process
```{r cleaning}
convert_num <- function(x){ #converts "12.3k" to 12300,  
  temp <- x
  if(str_detect(x, "k$")){
    temp <- x |> 
      str_replace_all("[^[:digit:]]", "") |> #gross but it just replaces any non-number with ""
      as.numeric() * 100
  }
  return(temp)
}

#data cleaning + joining
sanitation.clean <- sanitation.data |>
  drop_na() |>
  pivot_longer(cols = `1999`:`2019`,
               names_to = "year",
               values_to = "sanitation")

income.clean <- income.data |>
  drop_na() |> #pretty bold step to remove any rows with na vals, 
               #but due to the abundance of data seems reasonable
  select(c(country, `1999`:`2019`)) |>
  pivot_longer(cols = `1999`:`2019`,
               names_to = "year",
               values_to = "income") |>
  mutate(income = as.numeric(map(income, convert_num)))#converts characters,
  #able to convert after pivot, b/c data is all seen as strings!
```
The cleaning process above is relatively simple, converting some data entries of the form $12.3k \to 12300$. Notice that the decision to drop NA values was made, since `ggplot` and `lm` will drop NA values and we have an abundance of data entries. This decision will save headaches later down the road when taking advantae of the country column.

```{r join}
#| code-fold: false
full.data <- inner_join(sanitation.clean, income.clean)
head(full.data)
summary(full.data)
```
